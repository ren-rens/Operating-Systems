# Условие
Каква задача решава инструментът spinlock (активно изчакване)?
Опишете хардуерните инструменти, необходими за реализацията на spinlock.
В кои ситуации не бива да се ползва spinlock?
## Задача на spinlock
Spinlock е механизъм за синхронизация в многопроцесорни среди, който решава проблема с едновременния достъп до споделени ресурси от множество нишки или процеси.

Вместо да блокира нишката, която чака заключване, spinlock кара нишката да "върти" (spin) в цикъл и периодично проверява дали ресурсът е освободен, т.е. използва активно изчакване.

## Хардуерни инструменти
```
struct Spinlock:
lock: bool

spinlock_lock(s: Spinlock):
  disable_preemption()
  while atomic_test_and_set(s.lock):
    enable_preemption()
    relax()
    disable_preemption()

 spinlock_unlock(s: Spinlock):
   atomic_update(s.lock, false)
   enable_preemption()
```
## Ситуации, в които не трябва да се използва
Spinlock не трябва да се използва, когато:
1. Времето за изчакване е дълго:
Тъй като CPU активно проверява, това води до загуба на процесорно време.

2. Нишката може да бъде блокирана:
Ако нишката, която държи лок-а, чака друга, се получава deadlock или starvation.

3. В едноядрени системи:
Няма смисъл да "въртиш", ако нишката, която трябва да освободи ресурса, няма как да бъде планирана, защото CPU-то е заето със spinlock.

4. Ограничени ресурси или енергия:
Не е подходящ за мобилни устройства или енергийно ефективни системи, защото изразходва CPU безполезно.
